<!DOCTYPE html>
<html lang="pt-BR">
<head>
        <meta charset="utf-8">
        <link rel="icon" href="./favicon.ico">
        <title>Arcos de transição</title>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>

        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

        <style>
            .preformatted {
                font-family: monospace;
                white-space: pre;
            }
        </style>

        <script>
            function vai(){
                var tbl = document.getElementById("tabela-verdade").value;

                var valores = tbl.split("\n")

                for(var i=0;i<valores.length;i++){
                    valores[i] = valores[i].trim().split("\t");
                }

                var vars = [];
                for (i=0;i<valores[0].length-1;i++){
                    vars.push({var:String.fromCharCode(65+i), arcos:[]})
                }

                function analisaValores(variavel){
                    for(var i=0;i<valores.length;i++){

                        var entrada = valores[i][variavel];
                        var saida = valores[i][valores[i].length-1];

                        for(var j=0;j<valores.length;j++){
                            if (j === i) continue;
                            if (entrada === valores[j][variavel]) continue;
                            if (saida === valores[j][valores[j].length-1]) continue;

                            var arco = true;
                            for (var k=0;k<valores[j].length-1;k++){
                                if (k === variavel) continue;
                                if (valores[i][k] !== valores[j][k]){
                                    arco = false;
                                    break;
                                }
                            }

                            if (arco === false)
                                continue;

                            var jaIncluido = false;
                            for (var q=0; q<vars[variavel].arcos.length;q++){

                                var cont = 1;

                                for (var k=0;k<valores[i].length-1;k++){
                                    if (k === variavel) continue;
                                    if (valores[i][k] === vars[variavel].arcos[q][k]){
                                        cont++;
                                    }
                                }

                                if (cont === valores[i].length-1){
                                    jaIncluido = true;
                                    break;
                                }
                            }

                            if (jaIncluido === true)
                                continue;

                            vars[variavel].arcos.push(valores[i]);
                        }
                    }
                }

                var arcos = '';

                for (i=0;i<vars.length;i++){
                    analisaValores(i)

                    if (vars[i].arcos.length === 0) continue;

                    arcos += vars[i].var + " - ";
                    for(var j=0; j < vars[i].arcos.length; j++){
                        var arco = '';
                        for(var a=0; a< vars[i].arcos[j].length-1;a++){
                            if (a === i)
                                arco += vars[i].var;
                            else
                                arco += vars[i].arcos[j][a];
                        }
                        arcos += arco + " ";
                    }
                    arcos += "\n"
                }

                document.getElementById("resultado").innerHTML = arcos;
            }


        </script>
    </head>
    <body class="m-3">
        <h1>Identificador de Arcos de Transição</h1>
        <p>Um arco de transição ocorre quando apenas a modificação de bit de uma tabela verdade causa a modificação da saída.</p>

        <div class="mb-3">
            <label for="tabela-verdade" class="form-label">Tabela verdade</label>
            <textarea class="form-control" id="tabela-verdade" rows="4">0	0	0
1	0	0
0	1	0
1	1	1</textarea>
            <div id="tabela-verdadeHelp" class="form-text">Os valores devem estar separados por tab e as linhas por enter.</div>
        </div>

        <button type="button" class="btn btn-primary" id="bnt_plot" onclick="vai()">Gerar arcos de transição</button>
        <hr>
        <h2>Arcos de Transição identificados</h2>
        <div id="resultado"class="preformatted"></div>
        <script>vai()</script>
    </body>
</html>